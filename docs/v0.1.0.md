# v0.1.0
Goals for v0.1.0

## Key Manager
- HTTP server with REST API
- State that can be saved and restored

### API

#### Data Structures

```
// Defines a range for keys
Range {
  start: <start value>,
  end: <includive end value>,
  step: <increment value by step each time>
}

// Accounting for a client. Used in Jobs
Client {
  id: Unique ID for client
  managerKeyBlocks: [{ManagerKeyBlock}] // Array of key blocks sent to the client
  clientKeyBlocks: [{ClientKeyBlock}] // Array of key blocks the client has submitted
}

// Entire server side state
State {
  jobs: [{Job}] // Array of all Jobs
}

// The server side state of the Job
Job {
  jobConfig: {JobConfig}
  keys: {Range}|[], // Range object or an array of keys, depends on JobConfig
  clients: [{Client}] // Array of clients containing the keys they worked on
}

// Describes a simple config for a generic Scraper. Sent to the client
JobConfig {
  jobID: ID of the job
  url: http://example.com/cat_gifs/gif_${key}.gif // use ${} for substition
  keyType: range|unique // Type of keys in the related ManagerKeyBlock
  goodKeys: Number of successfull keys retrieved
  badKeys: Number of bad keys encountered
  unknownKeys: Number Keys yet to be tested
  scraperID: Unique name of the scraper binary/script/package in the Data Storage
}

// A Key Block recieved from the Key Manager
ManagerKeyBlock {
  keys: {Range}|[], // Range object or an array of keys, depends on JobConfig
  blockID: Unique ID assigned to Client by the server. Used in archive Names
  Expires: Unix timestamp when the block expires
}

// A Key block to be sent to the Manager
ClientKeyBlock {
  goodKeys: Array of keys that were successfully scraped
  badKeys: Array of keys that could not be retrieved
  unknownKeys: Array of keys that we did not try
  archiveID: Unique ID of the archive containing the data from this block
}

// Custom status object, sent on every response
Status {
  status:
    0: OK
    1: Server Error
    10: Invalid jobID
    11:
}

// Every request to the API will return a Status object and perhaps some other object
Response {
  Status: A custom status object with information,
  <Object>: The requested object. EG managerKeyBlock or jobConfig: [{JobConfig}]
}

```

#### Methods

Every request to the API will return a Status object and perhaps some other object

```
// void - Returns A Response object containing only a Status object

ManagerKeyBlock requestBlock(clientID, jobID, size)
void            submitBlock(ClientID, jobID, ClientKeyBlock)
JobConfig[]     getJobs()
```

## Client
- Client that can communicate with the Key Manager
- State that can be saved and restored
- Makes use of the interface exposed by the Key Manager
- Substitute keys into the URL and download HTML page
- Compress data
- Implementation is left up to person submitting the job
  - Scraper has to adhere to the API concerning I/O

### Output Standards
#### Data Archives
- Archive Name: `<jobID>-<scraperID>-<blockID>.tar.xz`
- Contents when scraping unique keys or a range of keys:
  - Where `<key>` is the name of the file containing the HTML/JSON
  - TODO: Extensions for `<key>`?
```
.
└── <jobID>-<scraperID>-<blockID>
    ├── <key>
    ├── <key2>
    └── <key3>
```
- When doing a discovery scrape, the keys are sent uding the HTTP API
